{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://raw.githubusercontent.com/ortfo/db/v1.2.0/schemas/database.schema.json",
  "$ref": "#/$defs/Database",
  "$defs": {
    "AnalyzedWork": {
      "properties": {
        "id": {
          "type": "string"
        },
        "builtAt": {
          "type": "string"
        },
        "descriptionHash": {
          "type": "string"
        },
        "metadata": {
          "$ref": "#/$defs/WorkMetadata"
        },
        "content": {
          "$ref": "#/$defs/LocalizableContent"
        },
        "Partial": {
          "type": "boolean"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "id",
        "builtAt",
        "descriptionHash",
        "metadata",
        "content",
        "Partial"
      ],
      "description": "AnalyzedWork represents a complete work, with analyzed mediae."
    },
    "ColorPalette": {
      "properties": {
        "primary": {
          "type": "string"
        },
        "secondary": {
          "type": "string"
        },
        "tertiary": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "primary",
        "secondary",
        "tertiary"
      ],
      "description": "ColorPalette reprensents the object in a Work's metadata.colors."
    },
    "ContentBlock": {
      "properties": {
        "id": {
          "type": "string"
        },
        "type": {
          "type": "string"
        },
        "anchor": {
          "type": "string"
        },
        "index": {
          "type": "integer"
        },
        "alt": {
          "type": "string"
        },
        "caption": {
          "type": "string"
        },
        "relativeSource": {
          "type": "string"
        },
        "distSource": {
          "type": "string"
        },
        "contentType": {
          "type": "string"
        },
        "size": {
          "type": "integer",
          "description": "in bytes"
        },
        "dimensions": {
          "$ref": "#/$defs/ImageDimensions"
        },
        "online": {
          "type": "boolean"
        },
        "duration": {
          "type": "number",
          "description": "in seconds"
        },
        "hasSound": {
          "type": "boolean"
        },
        "colors": {
          "$ref": "#/$defs/ColorPalette"
        },
        "thumbnails": {
          "$ref": "#/$defs/ThumbnailsMap"
        },
        "thumbnailsBuiltAt": {
          "type": "string"
        },
        "attributes": {
          "$ref": "#/$defs/MediaAttributes"
        },
        "analyzed": {
          "type": "boolean",
          "description": "whether the media has been analyzed"
        },
        "content": {
          "type": "string",
          "description": "html"
        },
        "text": {
          "type": "string"
        },
        "title": {
          "type": "string"
        },
        "url": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "id",
        "type",
        "anchor",
        "index",
        "alt",
        "caption",
        "relativeSource",
        "distSource",
        "contentType",
        "size",
        "dimensions",
        "online",
        "duration",
        "hasSound",
        "colors",
        "thumbnails",
        "thumbnailsBuiltAt",
        "attributes",
        "analyzed",
        "content",
        "text",
        "title",
        "url"
      ]
    },
    "Database": {
      "additionalProperties": {
        "$ref": "#/$defs/AnalyzedWork"
      },
      "type": "object"
    },
    "DatabaseMeta": {
      "properties": {
        "Partial": {
          "type": "boolean",
          "description": "Partial is true if the database was not fully built."
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "Partial"
      ]
    },
    "Footnotes": {
      "additionalProperties": {
        "type": "string"
      },
      "type": "object",
      "description": "Footnotes represents the footnote declarations in a description.md file."
    },
    "ImageDimensions": {
      "properties": {
        "width": {
          "type": "integer",
          "description": "Width in pixels"
        },
        "height": {
          "type": "integer",
          "description": "Height in pixels"
        },
        "aspectRatio": {
          "type": "number",
          "description": "width / height"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "width",
        "height",
        "aspectRatio"
      ],
      "description": "ImageDimensions represents metadata about a media as it's extracted from its file."
    },
    "Layout": {
      "items": {
        "items": {
          "type": "string"
        },
        "type": "array"
      },
      "type": "array",
      "description": "Layout is a 2D array of content block IDs"
    },
    "LocalizableContent": {
      "additionalProperties": {
        "$ref": "#/$defs/LocalizedContent"
      },
      "type": "object"
    },
    "LocalizedContent": {
      "properties": {
        "layout": {
          "$ref": "#/$defs/Layout"
        },
        "blocks": {
          "items": {
            "$ref": "#/$defs/ContentBlock"
          },
          "type": "array"
        },
        "title": {
          "type": "string"
        },
        "footnotes": {
          "$ref": "#/$defs/Footnotes"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "layout",
        "blocks",
        "title",
        "footnotes"
      ]
    },
    "MediaAttributes": {
      "properties": {
        "loop": {
          "type": "boolean",
          "description": "Controlled with attribute character ~ (adds)"
        },
        "autoplay": {
          "type": "boolean",
          "description": "Controlled with attribute character > (adds)"
        },
        "muted": {
          "type": "boolean",
          "description": "Controlled with attribute character > (adds)"
        },
        "playsinline": {
          "type": "boolean",
          "description": "Controlled with attribute character = (adds)"
        },
        "controls": {
          "type": "boolean",
          "description": "Controlled with attribute character = (removes)"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "loop",
        "autoplay",
        "muted",
        "playsinline",
        "controls"
      ],
      "description": "MediaAttributes stores which HTML attributes should be added to the media."
    },
    "ThumbnailsMap": {
      "patternProperties": {
        "^[0-9]+$": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "WorkMetadata": {
      "properties": {
        "aliases": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "finished": {
          "type": "string"
        },
        "started": {
          "type": "string"
        },
        "madeWith": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "tags": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "thumbnail": {
          "type": "string"
        },
        "titleStyle": {
          "type": "string"
        },
        "colors": {
          "$ref": "#/$defs/ColorPalette"
        },
        "pageBackground": {
          "type": "string"
        },
        "wip": {
          "type": "boolean"
        },
        "private": {
          "type": "boolean"
        },
        "additionalMetadata": {
          "type": "object"
        },
        "databaseMetadata": {
          "$ref": "#/$defs/DatabaseMeta"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "aliases",
        "finished",
        "started",
        "madeWith",
        "tags",
        "thumbnail",
        "titleStyle",
        "colors",
        "pageBackground",
        "wip",
        "private",
        "additionalMetadata",
        "databaseMetadata"
      ]
    }
  }
}
